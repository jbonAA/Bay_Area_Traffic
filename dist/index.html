
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.4.1/d3.min.js"></script>
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../src/application.css">
</head>
<script src="../src/data.js"></script>
<script src="../src/index.js"></script>
    <style>
            #line{
                width: 100%;
                margin: 20px 0;
                height: 300px;
            }
            .old {
                stroke: lightgrey;
                stroke-dasharray: 5;
                stroke-dashoffset: 5;
            }
    </style>
<script>
        
        

        function drawLines() {
            
            
            //working line draw     
            // function runTransition() {
            //     var pathTrans = d3.selectAll("path").transition().style("color", "white")
            //     pathTrans.attr("transform", "translate(0, 800)").duration(10000)
                    
            // }

           
            const bd = document.querySelector('#body')

            var height = bd.style.height
            var width = bd.style.width
            
            // var lineData = [ 
            //     { "x": 1,   "y": 5},  { "x": 20,  "y": 20},
            //     { "x": 40,  "y": 10}, { "x": 60,  "y": 40},
            //     { "x": 80,  "y": 5},  { "x": 100, "y": 800}
            // ];
            // debugger
            // var lineFunction = d3.line()
            //     .x(function(d) {return d.x})
            //     .y(function(d) {return d.y})
            //     .curve(d3.curveBasis)

            var svgContainer = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height)

                //testing gradient

            var svg = d3.select("line")
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                .attr("id", "visualization")

                
            var x = d3.scale.linear().domain([0, 500]).range([0, width]);
            var y = d3.scale.linear().domain([0, 500]).range([10, height - 10])

            var line = d3.line()
                .x(function(d, i) {return x(i)})
                .y(function(d) {return y(d)})
                .curve(d3.curveNatural)

            let repeat = () => {
                var data = d3.range(11).map(function(){return Math.random()*10})

                svg.selectAll("path").attr("class", "old");

                var path = svg.append("path")
                    .attr("d", line(data))
                    .attr("stroke", "white")
                    .attr("stroke-width", 2)
                    .attr("fill", "none")

                debugger

                var totalLength = path.node

                path
                    .attr("stroke-dasharray", totalLength + " " + totalLength)
                    .attr("stroke-dashoffset", totalLength)
                    .transition()
                        .duration(4000)
                        .ease(d3.easeLinear)
                        .attr("stroke-dashoffset", 0)
                        .on("end", repeat)
            }

            repeat()
            







            // var lineGraph = svgContainer.append("path")
            //     .attr("d", lineFunction(lineData))
            //     .attr("stroke", "blue")
            //     .attr("stroke-width", 2)
            //     .attr("fill", "none");
                    
            // runTransition()

            var svg = d3.select('svg');

            var backLayer = svg.append("g");
            var frontLayer = svg.append("g");

            var dataSet = d3.range(15).map(function (d) {
                return {
                    x: d * 30 + 10,
                    y: Math.random() * 600 + 10
                }
            });

            var lineGenerator = d3.svg.line()
                .x(function (d) {
                    return d.x
                })
                .y(function (d) {
                    return d.y
                })
                .interpolate("monotone")

            function displayCircles(data) {
                var circle = frontLayer.selectAll(null)
                    .data(data)
                    .enter()
                    .append('circle')
                    .attr({
                        r: 6,
                        cx: function (d) {
                            return d.x
                        },
                        cy: function (d) {
                            return d.y
                        },
                        fill: 'white',
                        stroke: "black",
                        "stroke-width": "3px"
                    });
            };

            function displayLine(data) {
                var line = backLayer.append("path")
                    .datum(data)
                    .attr({
                        d: lineGenerator(data),
                        fill: 'none',
                        stroke: "red",
                        "stroke-width": "3px",
                        "shape-rendering": "geometricPrecision"
                    });

                var totalLength = line.node().getTotalLength();

                line.attr("stroke-dasharray", totalLength + " " + totalLength)
                    .attr("stroke-dashoffset", totalLength)
                    .transition()
                    .duration(2000)
                    .ease("linear")
                    .attr("stroke-dashoffset", 0);
            }

            displayCircles(dataSet);

            setTimeout(function () {
                displayLine(dataSet)
            }, 1000)

        } 
        
        function returnTransition() {
            var pathTrans = d3.selectAll("line").transition()
            pathTrans.attr("transform", "translate(0, 1000)").duration(5000)
        }


            debugger


        

    
        </script>
<body id="body">
        <script src="main.js"></script>
        <div id="line"></div>
        <script>
                drawLines()
        </script>
</body>
</html>